<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Trabalhando com Spritesheets- Canvas HTML5</title>
        <script src="js/spritesheet.js"></script>
    </head>
    <body>
        <canvas id="palco" width="500" height="500">
            Ops! O seu navegador parece não ter suporte para este recurso.. :(
        </canvas>
        <script>
            // Encontra o canvas e o contexo 2D
            var canvas = document.getElementById('palco');
            var context = canvas.getContext('2d');
            
            // Cria um novo elemento de imagem para o nosso spritesheet do sonic
            var sonic = new Image();
            
            // Carrega a imagem do spritesheet do sonic no elemento sonic
            sonic.src = 'assets/images/spritesheet.png';
            
            // Cria um objeto do tipo Spritesheet, passando context, imagem, linhas e colunas
            var sheet = new Spritesheet(context, sonic, 3, 8);
            
            // Seta a duração de cada quadro da animação
            sheet.intervalo = 60;
            
            // Define qual linha sera animada (correndo para a direita)
            sheet.linha = 1;
            
            // Após carregar a imagem, chama a função gameLoop
            sonic.onload = gameLoop;
            
            // Função responsável por limpar o canvas,
            // avançar um quadro na animação e desenhar
            // no canvas o frame
            function gameLoop(){
                // Limpa o canvas
                context.clearRect(0, 0, context.canvas.width, context.canvas.height);
                
                // Avanca na animação
                sheet.proximoQuadro();
                
                // Desenha o quadro atual na posição enviada
                sheet.desenhar(100, 100);
                
                // faz um request para o próximo frame
                requestAnimationFrame(gameLoop);
            }
            
        </script>
    </body>
</html>
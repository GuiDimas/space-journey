<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Fundo Paralax - Canvas HTML5</title>
        <script src="js/animacao.js"></script>
        <script src="js/fundo.js"></script>
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
        <canvas id="palco" width="500" height="500">
            Ops! O seu navegador parece não ter suporte para este recurso.. :(
        </canvas>
        <script>
            // Carrega a imagem do espaço
            var imgEspaco = new Image();
            imgEspaco.src = 'assets/images/fundo-espaco.png';
            
            // Carega a imagem das estrelas
            var imgEstrelas = new Image();
            imgEstrelas.src = 'assets/images/fundo-estrelas.png';
            
            // Carrega a imagem das nuvens
            var imgNuvens = new Image();
            imgNuvens.src = 'assets/images/fundo-nuvens.png';
            
            // Variaveis de controle de imagens carregadas
            var carregadas = 0;
            var total = 3;
            
            // Definimos a função que será chamada quando as imagens forem carregando
            imgEspaco.onload = carregando;
            imgEstrelas.onload = carregando;
            imgNuvens.onload = carregando;
            
            // Funcao carregando
            function carregando() {
                carregadas++;
                if (carregadas == total) iniciar();
            }
            
            // Funcao de inicializacao
            function iniciar() {
                // Encontra o canvas e o contexo 2D
                var canvas = document.getElementById('palco');
                var context = canvas.getContext('2d');
                
                // Criamos objetos Fundo passando o context e a imagem
                var fundoEspaco = new Fundo(context, imgEspaco);
                var fundoEstrelas = new Fundo(context, imgEstrelas);
                var fundoNuvens = new Fundo(context, imgNuvens);
                
                // Definimos as velocidades que os fundos andarão
                fundoEspaco.velocidade = 3;
                fundoEstrelas.velocidade = 7;
                fundoNuvens.velocidade = 10;
                
                // Criamos o objeto de animação
                var animacao = new Animacao(context);
                
                // Adicionamos os sprites na animação
                animacao.novoSprite(fundoEspaco);
                animacao.novoSprite(fundoEstrelas);
                animacao.novoSprite(fundoNuvens);
                
                // Ligamos a animacao
                animacao.ligar();
            }
            
        </script>
    </body>
</html>